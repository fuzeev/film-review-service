# –°–µ—Ä–≤–∏—Å –¥–ª—è –æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –æ—Ç–∑—ã–≤–æ–≤ –∫ —Ñ–∏–ª—å–º–∞–º

–ü–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å —Å–ø–∏—Å–æ–∫ —Ñ–∏–ª—å–º–æ–≤, –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Ñ–∏–ª—å–º—ã –∏ –æ—Å—Ç–∞–≤–ª—è—Ç—å –æ—Ç–∑—ã–≤—ã. –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º JWT.

---

## üìÇ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–ü—Ä–æ–µ–∫—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø–∞–º **Clean Architecture** –Ω–∞ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–µ Symfony:

```
src/
‚îú‚îÄ‚îÄ Domain/         # –î–æ–º–µ–Ω–Ω—ã–π —Å–ª–æ–π: —Å—É—â–Ω–æ—Å—Ç–∏, –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤, –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îú‚îÄ‚îÄ Application/    # –°–ª–æ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: —Å—Ü–µ–Ω–∞—Ä–∏–∏ (UseCases), DTO –¥–ª—è –≤—Ö–æ–¥—è—â–∏—Ö –∏ –∏—Å—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ Infrastructure/ # –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–π —Å–ª–æ–π: —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤, –≤–Ω–µ—à–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ –∏ —Ç. –¥.
‚îî‚îÄ‚îÄ Presentation/   # –°–ª–æ–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è: –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã, –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è, –≤–∞–ª–∏–¥–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
```

**Flow –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–∞:**
1. Symfony-—Äo—É—Ç–∏–Ω–≥ –Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç HTTP-–∑–∞–ø—Ä–æ—Å –≤ –º–µ—Ç–æ–¥ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞.
2. –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –≤—Ö–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç DTO.
3. –í—ã–∑—ã–≤–∞–µ—Ç—Å—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π UseCase –∏–∑ —Å–ª–æ—è Application.
4. UseCase –æ–ø–µ—Ä–∏—Ä—É–µ—Ç –¥–æ–º–µ–Ω–Ω—ã–º–∏ —Å—É—â–Ω–æ—Å—Ç—è–º–∏ –∏ –∞–±—Å—Ç—Ä–∞–∫—Ü–∏—è–º–∏ (—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏, —Å–µ—Ä–≤–∏—Å—ã), –≤–Ω–µ–¥—Ä—ë–Ω–Ω—ã–º–∏ —á–µ—Ä–µ–∑ DI.
5. UseCase –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –∫–æ—Ç–æ—Ä—ã–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –≤ HTTP-–æ—Ç–≤–µ—Ç.

---

## ‚öôÔ∏è –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

1. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª—ã –æ–∫—Ä—É–∂–µ–Ω–∏—è:
    - `.env.local`
    - `.env.test.local`

### –ü—Ä–∏–º–µ—Ä `.env.local`
```dotenv
POSTGRES_USER=app
POSTGRES_PASSWORD=123456
POSTGRES_DB=app
POSTGRES_EXTERNAL_PORT=5438
DATABASE_URL="postgresql://app:123456@127.0.0.1:5438/app?serverVersion=17&charset=utf8"
JWT_PASSPHRASE=test
```

### –ü—Ä–∏–º–µ—Ä `.env.test.local`
```dotenv
DATABASE_URL="postgresql://app:123456@127.0.0.1:5438/app?serverVersion=17&charset=utf8"
```

2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
   ```bash
   symfony composer install
   ```

3. –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –∫–ª—é—á–∏ –¥–ª—è JWT:
```bash
mkdir -p config/jwt
openssl genrsa -out config/jwt/private.pem -aes256 4096
openssl rsa -pubout -in config/jwt/private.pem -out config/jwt/public.pem
```

4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∏ —Å–µ—Ä–≤–µ—Ä:
```bash
make up
symfony server:start
```

5. –î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:
```bash
symfony console --env=test doctrine:database:create
symfony console --env=test doctrine:schema:create
```

---

## üõ† –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã (Makefile)

| –ö–æ–º–∞–Ω–¥–∞           | –û–ø–∏—Å–∞–Ω–∏–µ                                         |
|-------------------|--------------------------------------------------|
| `make ecs`        | –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –∫–æ–¥–∞ —á–µ—Ä–µ–∑ ECS                |
| `make stan`       | –ê–Ω–∞–ª–∏–∑ –∫–æ–¥–∞ —Å PHPStan                            |
| `make ecs-fix`    | –ê–≤—Ç–æ—Ñ–∏–∫—Å —Å—Ç–∏–ª—è ECS                               |
| `make psalm`      | –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å –ø–æ–º–æ—â—å—é Psalm                         |
| `make psalm-info` | Psalm —Å –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π                    |
| `make fixtures`   | –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∏–∫—Å—Ç—É—Ä –≤ —Ç–µ—Å—Ç–æ–≤—É—é –ë–î                   |
| `make test`       | –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ PHPUnit                            |
| `make full-check` | –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ: `ecs`, `stan`, `psalm` –∏ `test` |
| `make up`         | –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤                      |
| `make down`       | –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤                            |
| `make restart`    | –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫: `down` + `up`                        |
| `make migration`  | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏ Doctrine                      |

---

## üìù –ü—Ä–æ—á–µ–µ

- –ö–æ–¥ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ ECS + PHPStan + Psalm.
- –í—Å–µ –≤–Ω–µ—à–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ Composer.

---
